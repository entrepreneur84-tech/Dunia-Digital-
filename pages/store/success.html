<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pembayaran Transfer Bank</title>

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:#0f172a;
  color:white;
  text-align:center;
  padding:25px;
}
.container{
  max-width:600px;
  margin:auto;
  background:#1e293b;
  padding:25px;
  border-radius:12px;
}
.box{
  background:#111827;
  padding:15px;
  border-radius:10px;
  margin:15px 0;
}
.price{
  font-size:28px;
  color:#22c55e;
}
button{
  padding:8px 12px;
  border:none;
  border-radius:6px;
  background:#2563eb;
  color:white;
  cursor:pointer;
  margin-top:5px;
}
.timer{
  color:#facc15;
}
.small{
  font-size:13px;
  opacity:0.8;
}
a{
  color:#22c55e;
  text-decoration:none;
}
</style>
</head>

<body>

<div class="container">

<h2>ðŸ’³ Pembayaran Transfer Bank</h2>

<div class="price" id="price"></div>
<p class="timer">Sisa waktu: <span id="timer"></span></p>

<!-- ================= BANK JAGO ================= -->
<div class="box">
<h3>Bank Jago</h3>
<p><b>Kode Bank:</b> 542</p>
<p><b>SWIFT/BIC:</b> ARTOIDJA</p>
<p><b>No. Rekening:</b> <span id="jago">109896731184</span></p>
<p><b>Atas Nama:</b> Ahmad Barizi</p>
<button onclick="copyText('jago')">Salin Rekening Jago</button>
</div>

<!-- ================= SEABANK ================= -->
<div class="box">
<h3>SeaBank / Bank Kesejahteraan Ekonomi</h3>
<p><b>Kode Bank:</b> 535</p>
<p><b>SWIFT:</b> SSPIIDJA</p>
<p><b>No. Rekening:</b> <span id="sea">901981495649</span></p>
<p><b>Atas Nama:</b> AHMAD BARIZI</p>
<button onclick="copyText('sea')">Salin Rekening SeaBank</button>
</div>

<hr style="opacity:0.2;margin:20px 0;">

<h3>Upload Bukti Transfer</h3>

<form id="uploadForm">
<input type="file" id="file" accept="image/*" required><br><br>
<button type="submit">Kirim Bukti Transfer</button>
</form>

<p class="small">
Setelah upload, tunggu verifikasi admin.
</p>

<hr style="opacity:0.2;margin:20px 0;">

<p>ðŸ“ž WhatsApp Admin:</p>
<a href="https://wa.me/6285175313909" target="_blank">
6285175313909
</a>

<p>ðŸ“§ Email:</p>
<p>barizilumajang@gmail.com</p>

</div>

<script>

const orderId = new URLSearchParams(window.location.search).get("order");

async function load(){
  const res = await fetch("/api/order?id="+orderId);
  const data = await res.json();

  document.getElementById("price").innerText =
    "Transfer Tepat: Rp " + data.price.toLocaleString("id-ID");

  startTimer(data.expiredAt);

  if(data.status === "paid"){
    window.location.href =
      "viewer.html?order="+orderId+"&token="+data.token;
  }
}

function startTimer(exp){
  setInterval(()=>{
    const diff = exp - Date.now();
    if(diff <= 0){
      document.getElementById("timer").innerText="EXPIRED";
      return;
    }
    const m = Math.floor(diff/1000/60);
    document.getElementById("timer").innerText=m+" menit";
  },1000);
}

function copyText(id){
  const text = document.getElementById(id).innerText;
  navigator.clipboard.writeText(text);
  alert("Disalin: " + text);
}

document.getElementById("uploadForm")
.addEventListener("submit", async function(e){
  e.preventDefault();

  const fd = new FormData();
  fd.append("orderId", orderId);
  fd.append("file", document.getElementById("file").files[0]);

  const res = await fetch("/api/upload", {
    method:"POST",
    body:fd
  });

  if(res.ok){
    alert("Bukti berhasil dikirim. Tunggu verifikasi.");
  }else{
    alert("Order sudah expired.");
  }
});

setInterval(load,5000);
load();

</script>

</body>
</html>yang 
